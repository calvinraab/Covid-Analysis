---
title: "Project1RMD"
author: "Group"
date: "4/15/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Here is where we can put our work. I imagine this is what we will turn in. 

Here I am uploading the original datasets: 
```{r}
library(readr)
library(dplyr)


library(leaps)




Fat_Supply_Quantity_Data <- read_csv("Fat_Supply_Quantity_Data.csv")
Food_Supply_Quantity_kg_Data <- read_csv("Food_Supply_Quantity_kg_Data.csv")
Food_Supply_kcal_Data <- read_csv("Food_Supply_kcal_Data.csv")
Protein_Supply_Quantity_Data <- read_csv("Protein_Supply_Quantity_Data.csv")
Supply_Food_Data_Descriptions <- read_csv("Supply_Food_Data_Descriptions.csv")
glimpse(Fat_Supply_Quantity_Data)
```

Data cleaning process. Here we can clean up that data and get it cleaned to the point where we will be able to work with it. 
```{r}
#select columns that are not filled with zeros
Fat_Supply_data <- Fat_Supply_Quantity_Data %>% select(Country, `Animal Products`, `Animal fats`, `Cereals - Excluding Beer`, Eggs, `Fish, Seafood`, `Fruits - Excluding Wine`, Meat, `Milk - Excluding Butter`, Offals, Oilcrops, Pulses, Spices, `Starchy Roots`, Stimulants, Treenuts, `Vegetal Products`, `Vegetable Oils`, Vegetables, Obesity, Undernourished, Population, Confirmed, Deaths)

Fat_Supply_data <- Fat_Supply_data[Fat_Supply_data$Deaths > 0,]
Fat_Supply_data <- Fat_Supply_data[!is.na(Fat_Supply_data$Deaths),]


Fat_Supply_data$Undernourished[Fat_Supply_data$Undernourished == "<2.5"] <- 2.5
Fat_Supply_data$Undernourished <- as.numeric(Fat_Supply_data$Undernourished)

data <- Fat_Supply_data


```

### Part 1 
Provide a descriptive analysis of your variables. This should include histograms and fitted distributions, correlation plot, boxplots, scatterplots, and statistical summaries (e.g., the five-number summary). All figures must include comments.
```{r}

```


### Part 2
Estimate a multiple linear regression model that includes all the main effects only (i.e., no interactions nor higher order terms). We will use this model as a baseline. Comment on the statistical and economic significance of your estimates. Also, make sure to provide an interpretation of your estimates.
```{r}

m1 <- lm(Deaths ~ ., data = Fat_Supply_data[,-c(1,23)])
summary(m1)




model_all <- lm(data$Deaths ~ data$`Animal Products` + data$`Animal fats` + data$`Cereals - Excluding Beer` + data$Eggs + data$`Fish, Seafood` + data$`Fruits - Excluding Wine` + data$Meat + data$`Milk - Excluding Butter` + data$Offals + data$Oilcrops + data$Pulses + data$Spices + data$`Starchy Roots` + data$Stimulants + data$Treenuts + data$`Vegetal Products` + data$`Vegetable Oils` + data$Vegetables + data$Obesity + data$Undernourished + data$Population)

summary(model_all)

n <- length(data$Deaths)

backAIC <- step(model_all ,direction="backward", data=data)
backBIC <- step(model_all ,direction="backward", data=data, k = log(n))
```


### Part 3
Identify if there are any outliers, high leverage, and or influential observations worth removing. If so, remove them but justify your reason for doing so and re-estimate your model.
```{r}

```

### Part 4
Use Mallows Cp for identifying which terms you will keep in the model (based on part 3) and also use the Boruta algorithm for variable selection. Based on the two results, determine which subset of predictors you will keep.
```{r}

```


### Part 5
Test for multicollinearity using VIF on the model from (4) . Based on the test, remove any appropriate variables, and estimate a new regression model based on these findings.
```{r}

```


### Part 6
For your model in part (5) plot the respective residuals vs. y_hat  and comment on your results.
```{r}

```


### Part 7
For your model in part (5) perform a RESET test and comment on your results.
```{r}

```


### Part 8
For your model in part (5) test for heteroskedasticity and comment on your results. If you identify heteroskedasticy, make sure to account for it before moving on to (9).
```{r}

```


### Part 9
Estimate a model based on all your findings that also includes interaction terms (if appropriate) and if needed, any higher power terms. Comment on the performance of this model compared to your other models. Make sure to use AIC and BIC for model comparison.
```{r}

```

### Part 10
Evaluate your model performance (from 9) using cross-validation, and also by dividing your data into the traditional 2/3 training and 1/3 testing samples, to evaluate your out-of-sample performance. Comment on your results. 
```{r}

```


### Part 11
Provide a short (1 paragraph) summary of your overall conclusions/findings.


